plugins {
	id "io.micronaut.build.internal.data-module"
    id "io.micronaut.build.internal.data-kotlin"
    id "org.jetbrains.kotlin.kapt"
	id 'org.checkerframework' version '0.6.17'
}

apply plugin: 'org.checkerframework'

repositories {
    // Use Maven Central for resolving dependencies.
    mavenCentral()
    mavenLocal()
}

checkerFramework {
    checkers = [
            'edu.ucr.cs.riple.taint.ucrtainting.UCRTaintingChecker',
    ]
    extraJavacArgs = [
            '-Awarns',
            '-AstubDebug'
    ]
}

dependencies {
	kapt mn.micronaut.inject.java
    kapt libs.micronaut.docs
	annotationProcessor mn.micronaut.inject.java
	annotationProcessor libs.micronaut.docs

	api projects.dataModel

	implementation libs.reactor

	compileOnly mn.micronaut.http
	compileOnly libs.jakarta.persistence.api
	compileOnly libs.javax.persistence.api

	testAnnotationProcessor mn.micronaut.inject.java
	testAnnotationProcessor projects.dataProcessor

	testImplementation libs.jakarta.persistence.api
	testImplementation libs.javax.persistence.api
	testImplementation projects.dataProcessor
	testImplementation mn.micronaut.inject.groovy
	testImplementation mn.micronaut.http
	testImplementation mn.micronaut.test.junit5
	testImplementation projects.dataTck

	checkerFramework 'edu.ucr.cs.riple.taint:ucrtainting-checker:0.1'
    implementation 'edu.ucr.cs.riple.taint:ucrtainting-checker:0.1'
}

dependencies {
    testRuntimeOnly libs.jupiter.engine

    kaptTest mn.micronaut.inject.java
    kaptTest projects.dataProcessor
    testAnnotationProcessor mn.micronaut.inject.java
    testAnnotationProcessor projects.dataProcessor
}

test {
    useJUnitPlatform()
}
